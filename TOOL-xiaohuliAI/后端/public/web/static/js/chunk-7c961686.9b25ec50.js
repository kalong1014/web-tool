(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c961686"],{"114b":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("a7fa"),n("f17d"),n("cac0"),n("0f4e"),n("c9c8"),n("c565"),n("96bb");var i=n("5f87");function o(){var e=this;this.apiUrl="/web.php/chat/sendText",this.onMessage=function(){},this.onError=function(){},this.onFinish=function(){},this.fetchCtrl="",this.outputStacks=[],this.outputSI=0,this.request=function(t){e.fetchCtrl=new AbortController;var n=new Headers;n.append("Content-Type","application/json"),n.append("X-token",Object(i["d"])()||""),n.append("X-site",Object(i["a"])()||""),fetch(this.apiUrl,{method:"POST",headers:n,body:JSON.stringify(t),signal:e.fetchCtrl.signal}).then((function(t){if(t.ok){var n=t.body.getReader(),i=new TextDecoder("utf-8");o(),e.startOutput()}else e.onError(t.statusText);function o(){n.read().then((function(t){var n=t.done,s=t.value;if(n)return e.stopOutput(),void e.onFinish();if(s){var a=i.decode(s);if(a){if(-1!==a.indexOf("[error]"))return e.stopOutput(),e.onError(a.replace("[error]","")),void e.onFinish();for(var r=0;r<a.length;r++)e.outputStacks.push(a[r])}}o()}))}})).catch((function(t){"AbortError"===t.name?(e.stopOutput(),e.onFinish(),console.log("请求已被取消")):console.log("网络错误",t)}))},this.startOutput=function(){e.stopOutput(),e.outputSI=setInterval((function(){e.outputStacks.length>0&&e.onMessage(e.outputStacks.shift())}),24)},this.stopOutput=function(){e.outputSI&&clearInterval(e.outputSI),e.outputSI=0,e.outputStacks.length>0&&e.onMessage(e.outputStacks.join("")),e.outputStacks=[]},this.stop=function(){e.fetchCtrl&&(e.fetchCtrl.abort(),e.fetchCtrl=null),e.stopOutput(),e.onFinish()}}},"5e88":function(e,t,n){},"61b0":function(e,t,n){},"7d5c":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"module-mind box-chat"},[n("div",{ref:"container",staticClass:"minder-container"}),e.minder?n("div",{staticClass:"minder-tools"},[n("drag",{attrs:{minder:e.minder},on:{"update:minder":function(t){e.minder=t}}}),n("zoom",{attrs:{minder:e.minder},on:{"update:minder":function(t){e.minder=t}}}),n("undo",{attrs:{minder:e.minder,editor:e.editor},on:{"update:minder":function(t){e.minder=t},"update:editor":function(t){e.editor=t}}}),n("redo",{attrs:{minder:e.minder,editor:e.editor},on:{"update:minder":function(t){e.minder=t},"update:editor":function(t){e.editor=t}}}),n("template-dropdown",{attrs:{minder:e.minder},on:{"update:minder":function(t){e.minder=t}}}),n("theme",{attrs:{minder:e.minder},on:{"update:minder":function(t){e.minder=t}}}),n("div",{staticClass:"split"}),n("resetview",{attrs:{minder:e.minder},on:{"update:minder":function(t){e.minder=t}}}),n("expand",{attrs:{minder:e.minder},on:{"update:minder":function(t){e.minder=t}}}),n("pick",{attrs:{minder:e.minder},on:{"update:minder":function(t){e.minder=t}}}),n("div",{staticClass:"split"}),n("fonts",{attrs:{minder:e.minder},on:{"update:minder":function(t){e.minder=t}}}),n("div",{staticClass:"split"}),n("export-data",{attrs:{minder:e.minder},on:{"update:minder":function(t){e.minder=t}}})],1):e._e(),n("ai",{attrs:{minder:e.minder},on:{"update:minder":function(t){e.minder=t}}})],1)},o=[],s=(n("e5895"),n("eca0"),n("9345"),n("28a3"),n("58b4"),n("564c"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"km-btn-group"},[n("el-row",[n("el-link",{attrs:{disabled:e.isDisabled("AppendChildNode"),underline:!1,type:"primary"},on:{click:function(t){return e.minder.execCommand("AppendChildNode","分支主题")}}},[n("i",{staticClass:"el-icon-bottom-right"}),e._v(" 插入下级")]),n("el-link",{attrs:{disabled:e.isDisabled("AppendParentNode"),underline:!1,type:"primary"},on:{click:function(t){return e.minder.execCommand("AppendParentNode","分支主题")}}},[n("i",{staticClass:"el-icon-top-left"}),e._v(" 插入上级")])],1),n("el-row",[n("el-link",{attrs:{disabled:e.isDisabled("AppendSiblingNode"),underline:!1,type:"primary"},on:{click:function(t){return e.minder.execCommand("AppendSiblingNode","分支主题")}}},[n("i",{staticClass:"el-icon-refresh"}),e._v(" 插入同级")])],1)],1)}),a=[],r={props:{minder:{type:Object,default:null}},methods:{isDisabled:function(e){return-1===this.minder.queryCommandState(e)}}},l=r,c=n("76b2"),d=Object(c["a"])(l,s,a,!1,null,null,null),u=(d.exports,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"km-btn-group"},[n("el-row",[n("el-link",{attrs:{disabled:e.isDisabled("ArrangeUp"),underline:!1,type:"primary"},on:{click:function(t){return e.minder.execCommand("ArrangeUp")}}},[n("i",{staticClass:"el-icon-arrow-up"}),e._v(" 上移")])],1),n("el-row",[n("el-link",{attrs:{disabled:e.isDisabled("ArrangeDown"),underline:!1,type:"primary"},on:{click:function(t){return e.minder.execCommand("ArrangeDown")}}},[n("i",{staticClass:"el-icon-arrow-down"}),e._v(" 下移")])],1)],1)}),m=[],p={props:{minder:{type:Object,default:null}},methods:{isDisabled:function(e){return-1===this.minder.queryCommandState(e)}}},f=p,h=Object(c["a"])(f,u,m,!1,null,null,null),b=(h.exports,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dropdown",{attrs:{placement:"bottom",trigger:"click"},on:{command:e.handleExpand}},[n("div",{staticClass:"tools-item"},[n("span",{staticClass:"el-dropdown-link"},[n("el-tooltip",{attrs:{content:"展开节点"}},[n("a",[e._v("展开")])])],1),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("div",{staticClass:"option-list"},e._l(e.expandItems,(function(t,i){return n("el-dropdown-item",{attrs:{command:i}},[n("div",{staticClass:"option-item"},[e._v(e._s(t))])])})),1)])],1)])}),v=[],g={props:{minder:{type:Object,default:null}},data:function(){return{expandItems:["全部展开","展开到 1 层节点","展开到 2 层节点","展开到 3 层节点","展开到 4 层节点","展开到 5 层节点","展开到 6 层节点"]}},methods:{handleExpand:function(e){this.minder.execCommand("ExpandToLevel",e||999)},handleSelected:function(e){this.selectNode(e)}}},C=g,y=Object(c["a"])(C,b,v,!1,null,null,null),x=y.exports,k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dropdown",{attrs:{placement:"bottom"},on:{command:e.handleSelected}},[n("div",{staticClass:"tools-item"},[n("span",{staticClass:"el-dropdown-link"},[n("el-tooltip",{attrs:{content:"选择节点"}},[n("a",[e._v("选择")])])],1),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("div",{staticClass:"option-list"},e._l(Object.keys(e.selectedItems),(function(t,i){return n("el-dropdown-item",{attrs:{command:i}},[n("div",{staticClass:"option-item"},[e._v(e._s(e.selectedItems[t]))])])})),1)])],1)])},w=[],_=(n("390d"),n("c9c8"),n("a7fa"),n("d3da"),n("2025"),{props:{minder:{type:Object,default:null}},data:function(){return{selectedItems:{selectall:"全选",selectrevert:"反选",selectlevel:"选中同级",selecttree:"选择子树"}}},methods:{handleSelected:function(e){var t=Object.keys(this.selectedItems)[e];this.selectNode(t)},selectNode:function(e){if(this.minder&&e){var t=this.minder,n={selectall:function(){var e=[];t.getRoot().traverse((function(t){e.push(t)})),t.select(e,!0),t.fire("receiverfocus")},selectrevert:function(){var e=t.getSelectedNodes(),n=[];t.getRoot().traverse((function(t){-1===e.indexOf(t)&&n.push(t)})),t.select(n,!0),t.fire("receiverfocus")},selectsiblings:function(){var e=t.getSelectedNodes(),n=[];e.forEach((function(e){e.parent&&e.parent.children.forEach((function(e){-1===n.indexOf(e)&&n.push(e)}))})),t.select(n,!0),t.fire("receiverfocus")},selectlevel:function(){var e=t.getSelectedNodes().map((function(e){return e.getLevel()})),n=[];t.getRoot().traverse((function(t){-1!==e.indexOf(t.getLevel())&&n.push(t)})),t.select(n,!0),t.fire("receiverfocus")},selectpath:function(){var e=t.getSelectedNodes(),n=[];e.forEach((function(e){while(e&&-1===n.indexOf(e))n.push(e),e=e.parent})),t.select(n,!0),t.fire("receiverfocus")},selecttree:function(){var e=t.getSelectedNodes(),n=[];e.forEach((function(e){e.traverse((function(e){-1===n.indexOf(e)&&n.push(e)}))})),t.select(n,!0),t.fire("receiverfocus")}};n[e]()}}}}),O=_,S=Object(c["a"])(O,k,w,!1,null,null,null),j=S.exports,N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"flex","align-items":"center"}},[n("div",{staticClass:"tools-item",class:{disabled:e.isDisabled("fontfamily")},staticStyle:{background:"transparent","padding-right":"3px"}},[n("el-select",{staticStyle:{width:"100px"},attrs:{disabled:e.isDisabled("fontfamily"),size:"mini",clearable:"",placeholder:"字体"},model:{value:e.font,callback:function(t){e.font=t},expression:"font"}},e._l(e.familyList,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),n("el-select",{staticStyle:{width:"65px","margin-left":"8px"},attrs:{disabled:e.isDisabled("fontsize"),size:"mini",clearable:"",placeholder:"字号"},model:{value:e.size,callback:function(t){e.size=t},expression:"size"}},e._l(e.sizeList,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),n("div",{staticStyle:{display:"flex","align-items":"center"}},[n("el-link",{staticClass:"tools-item",class:{active:1===e.minder.queryCommandState("italic"),disabled:e.isDisabled("italic")},attrs:{disabled:e.isDisabled("italic"),underline:!1},on:{click:e.italicChange}},[n("svg-icon",{staticClass:"icon",attrs:{"icon-class":"ic_mind_fontstyle"}})],1),n("el-link",{staticClass:"tools-item",class:{active:1===e.minder.queryCommandState("bold"),disabled:e.isDisabled("bold")},attrs:{disabled:e.isDisabled("bold"),underline:!1},on:{click:e.boldChange}},[n("svg-icon",{staticClass:"icon",attrs:{"icon-class":"ic_mind_fontweight"}})],1),n("el-popover",{attrs:{placement:"bottom",trigger:"click",disabled:e.isDisabled("forecolor")}},[n("colorPicker",{model:{value:e.color,callback:function(t){e.color=t},expression:"color"}}),n("el-link",{staticClass:"tools-item",class:{disabled:e.isDisabled("forecolor")},attrs:{slot:"reference",disabled:e.isDisabled("forecolor"),underline:!1},slot:"reference"},[n("svg-icon",{staticClass:"icon",style:"color:"+e.minder.queryCommandValue("forecolor"),attrs:{"icon-class":"ic_mind_fontcolor"}})],1)],1),n("el-popover",{attrs:{placement:"bottom",trigger:"click",disabled:e.isDisabled("background")}},[n("color-picker",{model:{value:e.backgroundColor,callback:function(t){e.backgroundColor=t},expression:"backgroundColor"}}),n("el-link",{staticClass:"tools-item",class:{disabled:e.isDisabled("background")},attrs:{slot:"reference",disabled:e.isDisabled("background"),underline:!1},slot:"reference"},[n("svg-icon",{staticClass:"icon",style:"color:"+e.minder.queryCommandValue("background"),attrs:{"icon-class":"ic_mind_bgcolor"}})],1)],1)],1)])},D=[],E=n("907e"),$={components:{colorPicker:E["Sketch"]},props:{minder:{type:Object,default:null}},data:function(){return{familyList:[{label:"宋体",value:"宋体,SimSun"},{label:"微软雅黑",value:"微软雅黑,Microsoft YaHei"},{label:"楷体",value:"楷体,楷体_GB2312,SimKai"},{label:"黑体",value:"黑体, SimHei"},{label:"隶书",value:"隶书, SimLi"},{label:"Andale Mono",value:"andale mono"},{label:"Arial",value:"arial,helvetica,sans-serif"},{label:"arialBlack",value:"arial black,avant garde"},{label:"Comic Sans Ms",value:"comic sans ms"},{label:"Impact",value:"impact,chicago"},{label:"Times New Roman",value:"times new roman"},{label:"Sans-Serif",value:"sans-serif"}],font:this.minder.queryCommandValue("fontfamily")||"微软雅黑,Microsoft YaHei",sizeList:[10,12,16,18,24,32,48],size:this.minder.queryCommandValue("fontsize")||16,color:{hex:this.minder.queryCommandValue("forecolor")},backgroundColor:{hex:this.minder.queryCommandValue("background")}}},watch:{font:function(){this.minder.execCommand("fontfamily",this.font)},size:function(){this.minder.execCommand("fontsize",this.size)},"color.hex":function(){this.minder.execCommand("forecolor",this.color.hex)},"backgroundColor.hex":function(){this.minder.execCommand("background",this.backgroundColor.hex)}},mounted:function(){var e=this;this.minder.on("contentchange",(function(){return e.$forceUpdate()}))},methods:{isDisabled:function(e){return-1===this.minder.queryCommandState(e)},italicChange:function(){this.minder.execCommand("italic"),this.$forceUpdate()},boldChange:function(){this.minder.execCommand("bold"),this.$forceUpdate()}}},q=$,z=Object(c["a"])(q,N,D,!1,null,null,null),A=z.exports,I=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-tooltip",{attrs:{content:"一键整理布局"}},[n("div",{staticClass:"tools-item"},[n("a",{on:{click:function(t){return e.minder.execCommand("resetlayout")}}},[e._v("整理")])])])},T=[],R={props:{minder:{type:Object,default:null}},methods:{}},V=R,M=Object(c["a"])(V,I,T,!1,null,null,null),L=(M.exports,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-tooltip",{attrs:{content:"调整视野到中心位置"}},[n("div",{staticClass:"tools-item"},[n("a",{on:{click:function(t){e.minder.execCommand("camera",e.minder.getSelectedNode()||e.minder.getRoot(),600)}}},[n("svg-icon",{staticClass:"icon",attrs:{"icon-class":"ic_mind_resetview"}})],1)])])}),U=[],P={props:{minder:{type:Object,default:null}},methods:{isDisabled:function(e){return-1===this.minder.queryCommandState(e)}}},F=P,H=Object(c["a"])(F,L,U,!1,null,null,null),J=H.exports,B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"km-btn-group"},[n("el-row",[n("el-link",{attrs:{disabled:e.isDisabled("note"),underline:!1,type:"primary"},on:{click:function(t){e.noteVisible=!0}}},[n("i",{staticClass:"el-icon-edit-outline"}),e._v(" 备注")])],1),n("el-row",[n("el-link",{attrs:{disabled:e.isDisabled("RemoveNode"),underline:!1,type:"primary"},on:{click:function(t){return e.minder.execCommand("RemoveNode")}}},[n("i",{staticClass:"el-icon-delete"}),e._v(" 删除")])],1),n("el-drawer",{attrs:{title:"编辑备注",visible:e.noteVisible},on:{"update:visible":function(t){e.noteVisible=t}}},[n("div",{staticStyle:{margin:"0 20px"}},[n("el-input",{attrs:{rows:"10",type:"textarea"},model:{value:e.note,callback:function(t){e.note=t},expression:"note"}})],1)])],1)},G=[],Z={props:{minder:{type:Object,default:null}},data:function(){return{noteVisible:!1,note:this.minder.queryCommandValue("note")}},watch:{note:function(){this.minder.execCommand("note",this.note)}},updated:function(){this.note=this.minder.queryCommandValue("note")},methods:{isDisabled:function(e){return-1===this.minder.queryCommandState(e)}}},K=Z,X=Object(c["a"])(K,B,G,!1,null,null,null),Y=(X.exports,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"km-btn-group"},[n("el-row",[n("el-link",{attrs:{disabled:e.isDisabled("copystyle"),underline:!1,type:"primary"},on:{click:function(t){return e.minder.execCommand("copystyle")}}},[n("i",{staticClass:"el-icon-copy-document"}),e._v(" 复制样式")]),n("el-link",{attrs:{disabled:e.isDisabled("clearstyle"),underline:!1,type:"primary"},on:{click:function(t){return e.minder.execCommand("clearstyle")}}},[n("i",{staticClass:"el-icon-delete-solid"}),e._v(" 清空样式")])],1),n("el-row",[n("el-link",{attrs:{disabled:e.isDisabled("pastestyle"),underline:!1,type:"primary"},on:{click:function(t){return e.minder.execCommand("pastestyle")}}},[n("i",{staticClass:"el-icon-document"}),e._v(" 粘贴样式")])],1)],1)}),Q=[],W={props:{minder:{type:Object,default:null}},mounted:function(){var e=this;this.minder.on("contentchange",(function(){return e.$forceUpdate()}))},methods:{isDisabled:function(e){return-1===this.minder.queryCommandState(e)}}},ee=W,te=Object(c["a"])(ee,Y,Q,!1,null,null,null),ne=(te.exports,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dropdown",{attrs:{placement:"bottom",trigger:"click"},on:{command:e.handleCommand}},[n("div",{staticClass:"tools-item"},[n("span",{staticClass:"el-dropdown-link"},[n("el-tooltip",{attrs:{content:"类型"}},[n("a",[n("svg-icon",{staticClass:"icon",attrs:{"icon-class":"ic_mind_tpl_"+e.curName}})],1)])],1),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("div",{staticClass:"tpl-list"},e._l(Object.keys(e.templateList),(function(t){return n("div",[n("el-dropdown-item",{attrs:{command:t}},[n("el-tooltip",{attrs:{content:e.titles[t],placement:"right"}},[n("div",{staticClass:"tpl-item",class:{active:e.curName===t}},[n("svg-icon",{attrs:{"icon-class":"ic_mind_tpl_"+t}})],1)])],1)],1)})),0)])],1)])}),ie=[],oe={props:{minder:{type:Object,default:null}},data:function(){return{templateList:window.kityminder.Minder.getTemplateList(),curName:"right",titles:{default:"思维导图",structure:"组织结构图",filetree:"目录组织图",right:"逻辑结构图 - 右","fish-bone":"鱼骨图",tianpan:"天盘图"}}},mounted:function(){this.curName=this.minder.queryCommandValue("template")||"default"},methods:{handleCommand:function(e){this.curName=e,this.minder.execCommand("template",e)}}},se=oe,ae=(n("942a"),Object(c["a"])(se,ne,ie,!1,null,"3c5df40a",null)),re=ae.exports,le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"flex","align-items":"center"}},[n("el-dropdown",{attrs:{placement:"bottom",trigger:"click"},on:{command:e.handleCommand}},[n("div",{staticClass:"tools-item"},[n("span",{staticClass:"el-dropdown-link"},[n("el-tooltip",{attrs:{content:"配色"}},[n("a",{staticClass:"color-block",style:"background-color: "+e.themes[e.curName.replace("-compat","")].color})])],1),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("div",{staticClass:"theme-list"},e._l(Object.keys(e.themes),(function(t){return n("el-dropdown-item",{attrs:{command:t}},[n("a",{staticClass:"theme-item",style:"background-color: "+e.themes[t].color},[e._v(e._s(e.themes[t].title))])])})),1)])],1)]),n("div",{staticClass:"tools-item",class:{active:-1!==e.curName.indexOf("-compat")},on:{click:e.switchCompat}},[n("el-tooltip",{attrs:{content:"紧凑布局"}},[n("a",[e._v("紧凑")])])],1)],1)},ce=[],de=(n("cac0"),n("0f4e"),{props:{minder:{type:Object,default:null},defaultTheme:{type:String,default:"fresh-green"}},data:function(){return{themes:{"fresh-red":{title:"红",color:"#bf7373"},"fresh-soil":{title:"黄",color:"#bf9373"},"fresh-green":{title:"绿",color:"#73bf76"},"fresh-blue":{title:"蓝",color:"#73a1bf"},"fresh-purple":{title:"紫",color:"#7b73bf"},"fresh-pink":{title:"粉",color:"#bf7394"}},curName:"fresh-green"}},computed:{thumbStyle:function(){var e=this.themes[this.curName.replace("-compat","")];return{color:e["color"],"border-radius":"10px","background-color":e["color"]}},isCompat:function(){return-1!==this.curName.indexOf("-compat")}},mounted:function(){this.defaultTheme?this.curName=this.defaultTheme:this.curName=this.minder.queryCommandValue("theme")||"fresh-green",this.minder.execCommand("theme",this.curName)},methods:{handleCommand:function(e){this.isCompat&&(e+="-compat"),this.curName=e,this.minder.execCommand("theme",this.curName)},switchCompat:function(){this.isCompat?this.curName=this.curName.replace("-compat",""):this.curName+="-compat",this.minder.execCommand("theme",this.curName)}}}),ue=de,me=(n("d4c7"),Object(c["a"])(ue,le,ce,!1,null,"3af8c582",null)),pe=me.exports,fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tools-item",class:{disabled:!e.hasUndo},on:{click:function(t){return e.editor.history.undo()}}},[n("el-tooltip",{attrs:{content:"撤销"}},[n("a",[n("svg-icon",{staticClass:"icon",attrs:{"icon-class":"ic_mind_undo"}})],1)])],1)},he=[],be={props:{editor:{type:Object,default:null},minder:{type:Object,default:null}},data:function(){return{hasUndo:!1}},mounted:function(){var e=this;this.minder.on("datachange contentchange",(function(){e.hasUndo=e.editor.history.hasUndo()}))}},ve=be,ge=Object(c["a"])(ve,fe,he,!1,null,null,null),Ce=ge.exports,ye=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tools-item",class:{disabled:!e.hasRedo},on:{click:function(t){return e.editor.history.redo()}}},[n("el-tooltip",{attrs:{content:"重做"}},[n("a",[n("svg-icon",{staticClass:"icon",attrs:{"icon-class":"ic_mind_redo"}})],1)])],1)},xe=[],ke={props:{editor:{type:Object,default:null},minder:{type:Object,default:null}},data:function(){return{hasRedo:!1}},mounted:function(){var e=this;this.minder.on("datachange contentchange",(function(){e.hasRedo=e.editor.history.hasRedo()}))}},we=ke,_e=Object(c["a"])(we,ye,xe,!1,null,null,null),Oe=_e.exports,Se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tools-item",class:{active:1===e.minder.queryCommandState("hand")},on:{click:function(t){return e.minder.execCommand("hand")}}},[n("el-tooltip",{attrs:{content:"拖动模式"}},[n("a",[n("svg-icon",{staticClass:"icon",attrs:{"icon-class":"ic_mind_drag"}})],1)])],1)},je=[],Ne={props:{editor:{type:Object,default:null},minder:{type:Object,default:null}},mounted:function(){}},De=Ne,Ee=Object(c["a"])(De,Se,je,!1,null,null,null),$e=Ee.exports,qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dropdown",{attrs:{trigger:"click",placement:"bottom"}},[n("div",{staticClass:"tools-item",staticStyle:{width:"52px"},on:{dblclick:function(t){return e.setZoom(100)}}},[n("span",{staticClass:"el-dropdown-link"},[n("a",[e._v(e._s(e.zoom)+"%")])]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-slider",{staticStyle:{height:"150px"},attrs:{min:10,max:200,vertical:"",value:e.zoom,"show-tooltip":!1,marks:{100:""}},on:{input:e.setZoom}})],1)],1)])},ze=[],Ae={props:{minder:{type:Object,default:null}},data:function(){return{zoom:100}},mounted:function(){var e=this;this.minder.setDefaultOptions({zoom:[10,20,40,60,80,100,120,140,160,180,200]}),this.minder.on("zoom",(function(t){e.zoom=t.zoom}))},methods:{setZoom:function(e){var t=e;this.zoom=t,this.minder.execCommand("zoom",t)}}},Ie=Ae,Te=Object(c["a"])(Ie,qe,ze,!1,null,null,null),Re=Te.exports,Ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dropdown",{attrs:{placement:"bottom",trigger:"click"},on:{command:e.handleExport}},[n("div",{staticClass:"tools-item"},[n("div",{staticClass:"el-dropdown-link"},[n("div",{staticStyle:{display:"flex","align-items":"center"}},[n("svg-icon",{staticClass:"icon",attrs:{"icon-class":"ic_mind_export"}}),n("a",{staticStyle:{"margin-left":"5px"}},[e._v("导出")])],1)]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("div",{staticClass:"option-list"},e._l(e.types,(function(t,i){return n("el-dropdown-item",{attrs:{command:i}},[n("div",{staticClass:"option-item"},[e._v(e._s(t.title))])])})),1)])],1)])},Me=[],Le=(n("c565"),n("4e9e")),Ue=n.n(Le),Pe={props:{minder:{type:Object,default:null}},data:function(){return{types:[{name:"png",title:"PNG图片（.png）",ext:"png"},{name:"svg",title:"SVG矢量图（.svg）",ext:"svg"},{name:"text",title:"文本文件（.txt）",ext:"txt"},{name:"markdown",title:"Markdown文件（.md）",ext:"md"},{name:"json",title:"JSON格式（.json）",ext:"json"}]}},methods:{handleExport:function(e){var t=this.types[e];this.minder.exportData(t.name).then((function(e){var n="";"png"===t.name?n=e:("json"===t.name&&(e=e.replace(',"version":"1.4.43"',"")),n=new Blob([e],{type:"text/plain;charset=utf-8"})),Ue.a.saveAs(n,"思维导图."+t.ext)}))}}},Fe=Pe,He=Object(c["a"])(Fe,Ve,Me,!1,null,null,null),Je=He.exports,Be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chat-input"},[n("div",{staticClass:"input"},[n("el-input",{ref:"messageInput",attrs:{placeholder:"告诉AI你想写什么...",type:"textarea",autofocus:!0,autosize:{minRows:1,maxRows:8}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter(t)}},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),e.writing?n("el-button",{staticClass:"btn-send btn-stop",attrs:{type:"default",title:e._f("lang")("生成中，点击停止")},on:{click:e.stopRequest}},[n("svg-icon",{attrs:{"icon-class":"ic_stop"}}),e._v(" 停止生成 ")],1):n("el-button",{staticClass:"btn-send",attrs:{type:"default",loading:e.writing,title:e._f("lang")("发送")},on:{click:e.requestAI}},[e.writing?e._e():n("i",{staticClass:"el-icon-position"}),e._v(" 发送 ")])],1)])},Ge=[],Ze=n("ca00"),Ke=n("114b"),Xe=new Ke["a"],Ye={props:{minder:{type:Object,default:null}},data:function(){return{message:"",writing:!1,writingText:""}},mounted:function(){var e=this;this.$nextTick((function(){e.$refs.messageInput.focus()}))},methods:{requestAI:function(){if(!this.writing&&!this.writingText){var e=Object(Ze["f"])(this.message);if(e){this.writing=!0,this.clearAllNodes(),this.minder.disableAnimation(),this.message="";var t=this;Xe.onMessage=function(e){e&&(t.writingText+=e,t.importMarkdown(t.writingText))},Xe.onError=function(n){t.writing=!1,t.message=e,-1!==n.indexOf("请登录")?(t.$modals.showLogin(),setTimeout((function(){t.$message.error(t.$lang(n))}),500)):-1!==n.indexOf("请充值")?(t.$modals.showPay("vip"),setTimeout((function(){t.$message.error(t.$lang(n))}),500)):t.$alert(n,"系统提示")},Xe.onFinish=function(){t.writing=!1,t.writingText="",t.minder.enableAnimation(),setTimeout((function(){0===t.minder._root.getChildren().length?(t.minder._root.setData("text","中心主题"),t.minder.refresh(),t.$message.error("生成失败")):t.$message.success("生成结束")}),500)},Xe.request({tool:"mind",message:e})}else this.$message.error("请输入内容")}},onEnter:function(e){return e.ctrlKey&&this.requestAI(),!1},stopRequest:function(){Xe.stop(),this.writing=!1,this.writingText=""},importMarkdown:function(e){var t=this;if(e=Object(Ze["f"])(e),e)try{this.minder.decodeData("markdown",e).then((function(e){e.data.text&&(t.clearAllNodes(),t.importNode(t.minder._root,e))}))}catch(n){}},importNode:function(e,t){for(var n in t.data)e.data.text!==t.data.text&&e.setData(n,t.data[n]);for(var i=e.getChildren()||[],o=t.children||[],s=0;s<o.length;s++)if(i[s]){for(var a in o[s].data)i[s].data[a]!==o[s].data[a]&&(i[s].setData(a,o[s].data[a]),this.minder.refresh());this.importNode(i[s],o[s])}else if(o[s].data.text){var r=this.minder.createNode(o[s].data,e);this.minder.refresh(),this.importNode(r,o[s])}},clearAllNodes:function(){while(this.minder._root.getChildren().length)this.minder.removeNode(this.minder._root.getChildren()[0]);this.minder._root.setData("text","生成中..."),this.minder.refresh()}}},Qe=Ye,We=Object(c["a"])(Qe,Be,Ge,!1,null,null,null),et=We.exports,tt={name:"Mind",components:{undo:Ce,redo:Oe,templateDropdown:re,theme:pe,resetview:J,expand:x,pick:j,fonts:A,drag:$e,zoom:Re,exportData:Je,ai:et},data:function(){return{minder:null,editor:null,aiInputShow:!1}},mounted:function(){this.editor=new window.kityminder.Editor(this.$refs.container),this.minder=window.minder=this.editor.minder,this.minder.execCommand("theme","fresh-green"),this.minder.execCommand("template","default")}},nt=tt,it=Object(c["a"])(nt,i,o,!1,null,null,null);t["default"]=it.exports},"942a":function(e,t,n){"use strict";n("61b0")},d4c7:function(e,t,n){"use strict";n("5e88")}}]);